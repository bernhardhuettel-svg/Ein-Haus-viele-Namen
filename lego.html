<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>3D Lego Haus – Debug & Basis</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
    body {
        margin: 0;
        font-family: system-ui, sans-serif;
        background: #f0f0f0;
        text-align: center;
    }

    header {
        padding: 20px;
        background: #ffffff;
        border-bottom: 1px solid #ccc;
    }

    #container {
        width: 100%;
        height: 600px;
        background: #dddddd;
        margin: 20px auto;
    }

    button {
        padding: 14px 28px;
        font-size: 16px;
        background: #28a745;
        color: #fff;
        border: none;
        border-radius: 6px;
        cursor: pointer;
    }

    button:hover {
        background: #218838;
    }
</style>

<!-- THREE.JS -->
<script src="https://cdn.jsdelivr.net/npm/three@0.152.2/build/three.min.js"></script>
</head>

<body>

<header>
    <h1>3D Lego Haus – sichere Basis</h1>
    <p>Wenn du hier etwas siehst, funktioniert WebGL korrekt.</p>
</header>

<div id="container"></div>

<button onclick="init3D()">Szene laden</button>

<script>
function init3D() {

    const container = document.getElementById("container");
    container.innerHTML = "";

    /* Szene */
    const scene = new THREE.Scene();
    scene.background = new THREE.Color(0xcceeff);

    /* Kamera */
    const camera = new THREE.PerspectiveCamera(
        60,
        container.clientWidth / container.clientHeight,
        0.1,
        1000
    );
    camera.position.set(0, 40, 80);
    camera.lookAt(0, 10, 0);

    /* Renderer (Safari-safe) */
    const renderer = new THREE.WebGLRenderer({
        antialias: true,
        powerPreference: "high-performance"
    });
    renderer.setSize(container.clientWidth, container.clientHeight);
    renderer.setPixelRatio(window.devicePixelRatio);
    container.appendChild(renderer.domElement);

    /* Licht */
    scene.add(new THREE.AmbientLight(0xffffff, 0.8));

    const dirLight = new THREE.DirectionalLight(0xffffff, 1.2);
    dirLight.position.set(50, 100, 50);
    scene.add(dirLight);

    /* Boden */
    const ground = new THREE.Mesh(
        new THREE.PlaneGeometry(200, 200),
        new THREE.MeshStandardMaterial({ color: 0x88aa66 })
    );
    ground.rotation.x = -Math.PI / 2;
    scene.add(ground);

    /* ===== TESTOBJEKT (MUSS SICHTBAR SEIN) ===== */
    const testCube = new THREE.Mesh(
        new THREE.BoxGeometry(10, 10, 10),
        new THREE.MeshStandardMaterial({ color: 0xff0000 })
    );
    testCube.position.set(0, 5, 0);
    scene.add(testCube);

    /* ===== ARCHITEKTUR – BASIS ===== */

    const stoneMat = new THREE.MeshStandardMaterial({ color: 0xaaaaaa });
    const woodMat  = new THREE.MeshStandardMaterial({ color: 0xc19a6b });
    const glassMat = new THREE.MeshStandardMaterial({
        color: 0x88ccff,
        transparent: true,
        opacity: 0.45
    });
    const roofMat  = new THREE.MeshStandardMaterial({ color: 0x3b5f3b });
    //Visuelle Trennung Sockel Haus
    const basePlate = new THREE.Mesh(
        new THREE.BoxGeometry(92, 0.6, 62),
        new THREE.MeshStandardMaterial({ color: 0x777777 })
    );
    basePlate.position.y = 6.3;
    scene.add(basePlate);
    /* Sockel */
    const base = new THREE.Mesh(
        new THREE.BoxGeometry(90, 6, 60),
        stoneMat
    );
    base.position.y = 3;
    scene.add(base);

    /* Hauptkubus */
    const mainHouse = new THREE.Mesh(
        new THREE.BoxGeometry(36, 13, 24),
        woodMat
    );
    mainHouse.position.set(6, 12.5, 0);
    scene.add(mainHouse);


    /* Glaswürfel */
    const glassCube = new THREE.Mesh(
        new THREE.BoxGeometry(18, 10, 14),
        glassMat
    );
    glassCube.position.set(-28, 15, 0);
    glassCube.material.opacity = 0.35;
    scene.add(glassCube);

    /* Dachgarten */
    const roofEdge = new THREE.Mesh(
        new THREE.BoxGeometry(40, 0.6, 28),
        stoneMat
    );
    roofEdge.position.set(6, 20.9, 0);
    scene.add(roofEdge);

    //Wand mit Fenster
    const frontGlass = new THREE.Mesh(
        new THREE.BoxGeometry(30, 9, 0.4),
        glassMat
    );
    frontGlass.position.set(6, 12.5, 12.3);
    scene.add(frontGlass);

    /* Render Loop */
    function animate() {
        requestAnimationFrame(animate);
        renderer.render(scene, camera);
    }
    animate();

    /* Resize */
    window.addEventListener("resize", () => {
        camera.aspect = container.clientWidth / container.clientHeight;
        camera.updateProjectionMatrix();
        renderer.setSize(container.clientWidth, container.clientHeight);
    });

    console.log("Szene erfolgreich geladen");
}
</script>

</body>
</html>
