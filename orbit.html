<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8" />
    <title>Grundstück & Haus – stabil mit Orbit</title>
    <style>
        body { margin: 0; overflow: hidden; }
        canvas { display: block; }
    </style>
</head>
<body>

<script type="module">
import * as THREE from 'https://cdn.jsdelivr.net/npm/three@0.158/build/three.module.js';
import { OrbitControls } from 'https://cdn.jsdelivr.net/npm/three@0.158/examples/jsm/controls/OrbitControls.js';

/* =========================
   SCENE
========================= */
const scene = new THREE.Scene();
scene.background = new THREE.Color(0xaec6cf);

/* =========================
   CAMERA
========================= */
const camera = new THREE.PerspectiveCamera(
    60,
    window.innerWidth / window.innerHeight,
    0.1,
    1000
);
camera.position.set(15, 10, 15);

/* =========================
   RENDERER
========================= */
const renderer = new THREE.WebGLRenderer({ antialias: true });
renderer.setSize(window.innerWidth, window.innerHeight);
document.body.appendChild(renderer.domElement);

/* =========================
   LIGHT
========================= */
scene.add(new THREE.AmbientLight(0xffffff, 0.6));

const dirLight = new THREE.DirectionalLight(0xffffff, 0.6);
dirLight.position.set(20, 30, 10);
scene.add(dirLight);

/* =========================
   GROUND
========================= */
const ground = new THREE.Mesh(
    new THREE.PlaneGeometry(40, 40),
    new THREE.MeshStandardMaterial({ color: 0x2e8b57 })
);
ground.rotation.x = -Math.PI / 2;
scene.add(ground);

/* =========================
   HOUSE
========================= */
const houseGroup = new THREE.Group();

const house = new THREE.Mesh(
    new THREE.BoxGeometry(8, 5, 6),
    new THREE.MeshStandardMaterial({ color: 0xb0b0b0 })
);
house.position.y = 2.5;
houseGroup.add(house);

// Tür
const door = new THREE.Mesh(
    new THREE.BoxGeometry(1.2, 2.2, 0.2),
    new THREE.MeshStandardMaterial({ color: 0x654321 })
);
door.position.set(0, 1.1, 3.1);
houseGroup.add(door);

// Fenster
const windowMat = new THREE.MeshStandardMaterial({ color: 0x87cefa });
const windowGeo = new THREE.BoxGeometry(1.2, 1.2, 0.2);

const w1 = new THREE.Mesh(windowGeo, windowMat);
w1.position.set(-2.5, 2.8, 3.1);
houseGroup.add(w1);

const w2 = w1.clone();
w2.position.x = 2.5;
houseGroup.add(w2);

scene.add(houseGroup);

/* =========================
   RENDER NUR DAS HAUS ZUERST
========================= */
renderer.render(scene, camera);

/* =========================
   ORBIT CONTROLS – NACH DEM ERSTEN RENDER
========================= */
const controls = new OrbitControls(camera, renderer.domElement);
controls.target.set(0, 2, 0); // Kamera schaut auf Haus
controls.enableDamping = true;
controls.update(); // initiales Update

/* =========================
   ANIMATIONSSCHLEIFE
========================= */
function animate() {
    requestAnimationFrame(animate);
    controls.update();
    renderer.render(scene, camera);
}
animate();

/* =========================
   RESIZE
========================= */
window.addEventListener('resize', () => {
    camera.aspect = window.innerWidth / window.innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(window.innerWidth, window.innerHeight);
});
</script>

</body>
</html>
